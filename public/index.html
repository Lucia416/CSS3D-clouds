<!DOCTYPE html>
  <html>
    <head>
    	<meta charset="utf-8">
    	<title>Clouds</title>
      <link rel="stylesheet" href="./styles/layout.css" type="text/css" />
    </head>
      <body>
        <div id="viewport">
          <div id='world'>
            <div class="clouds" id = "one">
              <img class="cloudLayer" style="transform: translateX(15.1979px) translateY(-41.8665px) translateZ(-62.7274px) rotateZ(163.294deg) scale(0.609165);">
            </div>
            <div class="clouds" id = "two"></div>
            <div class="clouds" id = "three"></div>
            <div class="clouds" id = "four"></div>
            <div class="clouds" id = "five"></div>
          </div>
        </div>

        <script>




        	var layers = [],
        		objects = [],

        		world = document.getElementById( 'world' ),
        		viewport = document.getElementById( 'viewport' ),

        		d = 0,
        		p = 400,
        		worldXAngle = 0,
        		worldYAngle = 0;

        	viewport.style.webkitPerspective = p;
        	viewport.style.MozPerspective = p;
        	viewport.style.oPerspective = p;

        	generate();

        	function createCloud() {

        		var div = document.createElement( 'div'  );
        		div.className = 'clouds';
        		var x = 256 - ( Math.random() * 512 );
        		var y = 256 - ( Math.random() * 512 );
        		var z = 256 - ( Math.random() * 512 );
        		var t = 'translateX( ' + x + 'px ) translateY( ' + y + 'px ) translateZ( ' + z + 'px )';
        		div.style.webkitTransform = t;
        		div.style.MozTransform = t;
        		div.style.oTransform = t;
        		world.appendChild( div );

        		for( var j = 0; j < 5 + Math.round( Math.random() * 10 ); j++ ) {
        			var cloud = document.createElement( 'img' );
        			cloud.className = 'cloudLayer';

        			var x = 256 - ( Math.random() * 512 );
        			var y = 256 - ( Math.random() * 512 );
        			var z = 100 - ( Math.random() * 200 );
        			var a = Math.random() * 360;
        			var s = .25 + Math.random();
        			x *= .2; y *= .2;
        			cloud.data = {
        				x: x,
        				y: y,
        				z: z,
        				a: a,
        				s: s
        			};
        			var t = 'translateX( ' + x + 'px ) translateY( ' + y + 'px ) translateZ( ' + z + 'px ) rotateZ( ' + a + 'deg ) scale( ' + s + ' )';
        			cloud.style.webkitTransform = t;
        			cloud.style.MozTransform = t;
        			cloud.style.oTransform = t;

        			div.appendChild( cloud );
        			layers.push( cloud );
        		}

        		return div;
        	}

        	window.addEventListener( 'mousewheel', onContainerMouseWheel );
        	window.addEventListener( 'DOMMouseScroll', onContainerMouseWheel );
        	window.addEventListener( 'mousemove', onMouseMove );
        	window.addEventListener( 'touchmove', onMouseMove );

        	function onMouseMove ( e ) {

        		var x = e.clientX || e.touches[ 0 ].clientX;
        		var y = e.clientY || e.touches[ 0 ].clientY;

        		worldYAngle = -( .5 - ( x / window.innerWidth ) ) * 180;
        		worldXAngle = ( .5 - ( y / window.innerHeight ) ) * 180;
        		updateView();
        		event.preventDefault();

        	}

        	function onContainerMouseWheel( event ) {

        		event = event ? event : window.event;
        		d = d - ( event.detail ? event.detail * -5 : event.wheelDelta / 8 );
        		updateView();
        		event.preventDefault();

        	}

        	function generate() {

        		objects = [];

        		if ( world.hasChildNodes() ) {
        			while ( world.childNodes.length >= 1 ) {
        				world.removeChild( world.firstChild );
        			}
        		}

        		for( var j = 0; j < 5; j++ ) {
        			objects.push( createCloud() );
        		}

        	}

        	function updateView() {

        		var t = 'translateZ( ' + d + 'px ) rotateX( ' + worldXAngle + 'deg) rotateY( ' + worldYAngle + 'deg)';
        		world.style.webkitTransform = t;
        		world.style.MozTransform = t;
        		world.style.oTransform = t;

        	}





        </script>
      </body>
  </html>
